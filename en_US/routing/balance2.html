<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Load Balancing - Continued | V2Ray Beginner&#39;s Guide</title>
    <meta name="description" content="Step-by-step guide for first-timers&#39; using V2Ray.">
    
    
    <link rel="preload" href="/assets/css/0.styles.39798381.css" as="style"><link rel="preload" href="/assets/js/app.eff64834.js" as="script"><link rel="preload" href="/assets/js/2.459cdd8f.js" as="script"><link rel="preload" href="/assets/js/79.86020c19.js" as="script"><link rel="prefetch" href="/assets/js/10.d23bf7b4.js"><link rel="prefetch" href="/assets/js/11.355ed2fa.js"><link rel="prefetch" href="/assets/js/12.da62e0e5.js"><link rel="prefetch" href="/assets/js/13.101e3f71.js"><link rel="prefetch" href="/assets/js/14.aa858b78.js"><link rel="prefetch" href="/assets/js/15.1b815b2d.js"><link rel="prefetch" href="/assets/js/16.a0886e6e.js"><link rel="prefetch" href="/assets/js/17.696f15ad.js"><link rel="prefetch" href="/assets/js/18.c6cb309f.js"><link rel="prefetch" href="/assets/js/19.2b40129e.js"><link rel="prefetch" href="/assets/js/20.7f5813c7.js"><link rel="prefetch" href="/assets/js/21.612d6928.js"><link rel="prefetch" href="/assets/js/22.43c09d16.js"><link rel="prefetch" href="/assets/js/23.7983ac26.js"><link rel="prefetch" href="/assets/js/24.5aa6913b.js"><link rel="prefetch" href="/assets/js/25.76f29737.js"><link rel="prefetch" href="/assets/js/26.bd4ff18c.js"><link rel="prefetch" href="/assets/js/27.ade444ef.js"><link rel="prefetch" href="/assets/js/28.c3d992a1.js"><link rel="prefetch" href="/assets/js/29.930944dd.js"><link rel="prefetch" href="/assets/js/3.160e02e5.js"><link rel="prefetch" href="/assets/js/30.b9ea2a0c.js"><link rel="prefetch" href="/assets/js/31.b2c514b7.js"><link rel="prefetch" href="/assets/js/32.54154643.js"><link rel="prefetch" href="/assets/js/33.ed612bc6.js"><link rel="prefetch" href="/assets/js/34.0c7e4154.js"><link rel="prefetch" href="/assets/js/35.303e32bb.js"><link rel="prefetch" href="/assets/js/36.75dec598.js"><link rel="prefetch" href="/assets/js/37.76f46378.js"><link rel="prefetch" href="/assets/js/38.0785a5e4.js"><link rel="prefetch" href="/assets/js/39.1ac82dd8.js"><link rel="prefetch" href="/assets/js/4.bfd52344.js"><link rel="prefetch" href="/assets/js/40.1a74b3d7.js"><link rel="prefetch" href="/assets/js/41.279409cf.js"><link rel="prefetch" href="/assets/js/42.dc9902d4.js"><link rel="prefetch" href="/assets/js/43.7aaf363d.js"><link rel="prefetch" href="/assets/js/44.3a4d07e9.js"><link rel="prefetch" href="/assets/js/45.1c9cc058.js"><link rel="prefetch" href="/assets/js/46.cb671400.js"><link rel="prefetch" href="/assets/js/47.a2d771f1.js"><link rel="prefetch" href="/assets/js/48.b1644493.js"><link rel="prefetch" href="/assets/js/49.786ecf7b.js"><link rel="prefetch" href="/assets/js/5.b6354a15.js"><link rel="prefetch" href="/assets/js/50.881fd6b6.js"><link rel="prefetch" href="/assets/js/51.bef48a4b.js"><link rel="prefetch" href="/assets/js/52.d4a3450b.js"><link rel="prefetch" href="/assets/js/53.c78d550f.js"><link rel="prefetch" href="/assets/js/54.dac3a69c.js"><link rel="prefetch" href="/assets/js/55.eb062ed5.js"><link rel="prefetch" href="/assets/js/56.043f1fa8.js"><link rel="prefetch" href="/assets/js/57.fd0d2550.js"><link rel="prefetch" href="/assets/js/58.10a420fc.js"><link rel="prefetch" href="/assets/js/59.879da473.js"><link rel="prefetch" href="/assets/js/6.0d19d53d.js"><link rel="prefetch" href="/assets/js/60.c196b01e.js"><link rel="prefetch" href="/assets/js/61.fd6aaa4a.js"><link rel="prefetch" href="/assets/js/62.3799a338.js"><link rel="prefetch" href="/assets/js/63.1d84108f.js"><link rel="prefetch" href="/assets/js/64.be774727.js"><link rel="prefetch" href="/assets/js/65.d9129213.js"><link rel="prefetch" href="/assets/js/66.14992038.js"><link rel="prefetch" href="/assets/js/67.5b1a6ad2.js"><link rel="prefetch" href="/assets/js/68.c964c377.js"><link rel="prefetch" href="/assets/js/69.1e118f0f.js"><link rel="prefetch" href="/assets/js/7.39a0de8a.js"><link rel="prefetch" href="/assets/js/70.d50b6bfb.js"><link rel="prefetch" href="/assets/js/71.f070b40b.js"><link rel="prefetch" href="/assets/js/72.fd731ec9.js"><link rel="prefetch" href="/assets/js/73.f1b2ef63.js"><link rel="prefetch" href="/assets/js/74.2df3e49a.js"><link rel="prefetch" href="/assets/js/75.229f5f9b.js"><link rel="prefetch" href="/assets/js/76.8cd201be.js"><link rel="prefetch" href="/assets/js/77.e216d2d5.js"><link rel="prefetch" href="/assets/js/78.ace62114.js"><link rel="prefetch" href="/assets/js/8.ccad3e88.js"><link rel="prefetch" href="/assets/js/80.36e5a4c0.js"><link rel="prefetch" href="/assets/js/81.0f2696a6.js"><link rel="prefetch" href="/assets/js/82.b371c361.js"><link rel="prefetch" href="/assets/js/83.e16f037d.js"><link rel="prefetch" href="/assets/js/84.b6a827c7.js"><link rel="prefetch" href="/assets/js/85.7c0ff82a.js"><link rel="prefetch" href="/assets/js/86.4a6d8bd6.js"><link rel="prefetch" href="/assets/js/87.bc0c1c98.js"><link rel="prefetch" href="/assets/js/88.20aa46d3.js"><link rel="prefetch" href="/assets/js/89.a939bcb4.js"><link rel="prefetch" href="/assets/js/9.e12c3dad.js"><link rel="prefetch" href="/assets/js/90.795e8d0a.js"><link rel="prefetch" href="/assets/js/91.16a810e9.js"><link rel="prefetch" href="/assets/js/92.dc4d69a7.js"><link rel="prefetch" href="/assets/js/93.1e7d8023.js"><link rel="prefetch" href="/assets/js/94.44d12ac7.js"><link rel="prefetch" href="/assets/js/95.560c4a30.js">
    <link rel="stylesheet" href="/assets/css/0.styles.39798381.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/en_US/" class="home-link router-link-active"><!----> <span class="site-name">V2Ray Beginner's Guide</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://v2fly.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Official Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/routing/balance2.html" class="nav-link">zh-CN</a></li><li class="dropdown-item"><!----> <a href="/en_US/routing/balance2.html" class="nav-link router-link-exact-active router-link-active">en-US</a></li><li class="dropdown-item"><!----> <a href="/fa/" class="nav-link">fa-IR</a></li><li class="dropdown-item"><!----> <a href="/ko_KR/" class="nav-link">ko-KR</a></li><li class="dropdown-item"><!----> <a href="/ru_RU/" class="nav-link">ru-RU</a></li><li class="dropdown-item"><!----> <a href="/vi_VN/" class="nav-link">vi-VN</a></li><li class="dropdown-item"><!----> <a href="/fr_FR/" class="nav-link">fr-FR</a></li></ul></div></div> <a href="https://github.com/v2fly/v2ray-step-by-step" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://v2fly.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Official Guide
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/routing/balance2.html" class="nav-link">zh-CN</a></li><li class="dropdown-item"><!----> <a href="/en_US/routing/balance2.html" class="nav-link router-link-exact-active router-link-active">en-US</a></li><li class="dropdown-item"><!----> <a href="/fa/" class="nav-link">fa-IR</a></li><li class="dropdown-item"><!----> <a href="/ko_KR/" class="nav-link">ko-KR</a></li><li class="dropdown-item"><!----> <a href="/ru_RU/" class="nav-link">ru-RU</a></li><li class="dropdown-item"><!----> <a href="/vi_VN/" class="nav-link">vi-VN</a></li><li class="dropdown-item"><!----> <a href="/fr_FR/" class="nav-link">fr-FR</a></li></ul></div></div> <a href="https://github.com/v2fly/v2ray-step-by-step" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Preface</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/en_US/" class="sidebar-link">Guide to V2Ray configuration</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/prep/prep" class="sidebar-heading clickable"><span>Before start</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/basics/basics" class="sidebar-heading clickable"><span>Basics</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/advanced/advanced" class="sidebar-heading clickable"><span>Advanced</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/app/app" class="sidebar-heading clickable"><span>Practical</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/en_US/routing/routing" class="sidebar-heading clickable open"><span>Routing</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/en_US/routing/sitedata.html" class="sidebar-link">Domain file</a></li><li><a href="/en_US/routing/bittorrent.html" class="sidebar-link">Restricting BitTorrent</a></li><li><a href="/en_US/routing/balance2.html" class="active sidebar-link">Load Balancing - Continued</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/en_US/routing/balance2.html#configuration" class="sidebar-link">Configuration</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="load-balancing-continued"><a href="#load-balancing-continued" class="header-anchor">#</a> Load Balancing - Continued</h1> <p>As mentioned in the previous chapter,  V2Ray provides load balancing feature. However, the above-mentioned load balancing is implemented by improper configuration, it does not have good performance. Also, there's some people think its polling mechanism is not load balancing at all. However, after a long wait, V2Ray can finally load balance. Note that V2Ray version is required higher than 4.3 in order to enable the new load balancing feature.</p> <h2 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h2> <p>The load balancing is configured in the routing section and only need to be set on the client-side. In routing section, you need to configure an array of balancers that represents the rules for load balancing, each object contains a load-balanced unique label as working strategy (the current policy is random selection only), as an optional outbound proxy. Then configure specific traffic for load balancing as needed in the routing rules. In this example, the last routing rule is load balancing. According to our example: for the destination address is either private IP or mainland China, they will be directly connected; for all other traffic, they will relay to load balancing b1 (that is, choose between jp1 and jp2). Load balancing to b2 is not used in this example.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>

  <span class="token property">&quot;inbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    ...
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;outbounds&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;us1&quot;</span><span class="token punctuation">,</span>
      ...
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jp1&quot;</span><span class="token punctuation">,</span>
      ...
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jp2&quot;</span><span class="token punctuation">,</span>
      ...
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hk1&quot;</span><span class="token punctuation">,</span>
      ...
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">,</span>
      ...
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;routing&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;domainStrategy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;IPOnDemand&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;balancers&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;b1&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;selector&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;jp1&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;jp2&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;tag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;b2&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;selector&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;us1&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;hk1&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;rules&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;outboundTag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;ip&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;geoip:private&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;geoip:cn&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;outboundTag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;direct&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;domain&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;geosite:cn&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;network&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tcp,udp&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;balancerTag&quot;</span><span class="token operator">:</span> <span class="token string">&quot;b1&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>From the configuration, V2Ray's load balancing has the advantage of high flexibility. It can load balance the specified traffic, or configure multiple load balancing as needed. The outbound protocols of different underlying transmission configurations can also be load balanced. It can be said that the flexible routing of V2Ray is so flexible as its load balancing.</p> <p>Maybe due to balancer is newly implemented, currentlly the only strategy choosing route is random. As time progresses, there may be more strategies available.</p> <h4 id="updates"><a href="#updates" class="header-anchor">#</a> Updates</h4> <ul><li>2018-11-09 Initial Version.</li> <li>2019-11-01 Fix bugs of IP rules do not match</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/21/2019, 12:17:12 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/en_US/routing/bittorrent.html" class="prev">Restricting BitTorrent</a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.eff64834.js" defer></script><script src="/assets/js/2.459cdd8f.js" defer></script><script src="/assets/js/79.86020c19.js" defer></script>
  </body>
</html>
